{
  "hash": "90825aaf2627c9aece635ffef29e9b24",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Projeto Estatística\"\ntoc: true\n---\n\n\n\n## 1. Introdução\n\nNeste projeto, será realizado uma análise estatística com o objetivo de investigar possíveis relações entre fatores, como, por exemplo, idade, horas de estudo, e como impactam o desempenho acadêmico de um estudante.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Instala biblioteca caso necessário \nif (!require(readxl)) install.packages(\"readxl\") \n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: readxl\n```\n\n\n:::\n\n```{.r .cell-code}\n# Importando biblioteca para ler arquivo .xslx \nlibrary(readr) \n# Lendo base de dados \ndados <- read_xlsx(\"base_de_dados.xlsx\")\n```\n:::\n\n\n\n## 2. A Base de Dados\n\nA base de dados é composta por 943 observações e 9 variáveis, cada uma representando uma característica ou comportamento relacionado ao desempenho escolar. Abaixo estão listadas as variáveis investigadas, seus significados e respectivas unidades de medida:\n\n1.  Idade\n\n    -   Tipo: Quantitativa\n\n    -   Descrição: Indica a idade do aluno\n\n    -   Unidade de medida: Anos\n\n2.  Horas de estudos\n\n    -   Tipo: Quantitativa\n\n    -   Descrição: Indica o tempo total de estudo de um aluno\n\n    -   Unidade de medida: Horas\n\n3.  Frequência\n\n    -   Tipo: Quantitativa\n\n    -   Descrição: Representa a frequência do aluno nas aulas\n\n    -   Unidade de Medida: Percentual (%)\n\n4.  Atividades extracurriculares\n\n    -   Tipo: Categórica\n\n    -   Descrição: Indica se o aluno participa de atividades extracurriculares\n\n    -   Unidade de medida: Pode ser Sim/Não\n\n5.  Nível socioeconômico\n\n    -   Tipo: Categórica\n\n    -   Descrição: Representa a condição econômica e social do aluno\n\n    -   Unidade de medida: Pode ser Alto/Médio/Baixo\n\n6.  Motivação\n\n    -   Tipo: Quantitativa\n\n    -   Descrição: Mede o nível de motivação do aluno em relação aos estudos\n\n    -   Unidade de medida: Percentual (%)\n\n7.  Notas anteriores\n\n    -   Tipo: Quantitativa\n\n    -   Descrição: Refere-se ao desempenho escolar (média) de um aluno em avaliações escolares\n\n    -   Unidade de medida: Nota numérica (de 0 a 10)\n\n8.  Sono\n\n    -   Tipo: Quantitativa\n\n    -   Descrição: Indica o tempo médio de sono diário de um aluno\n\n    -   Unidade de medida: Horas\n\n9.  Desempenho\n\n    -   Tipo: Quantitativa\n\n    -   Descrição: Refere-se ao desempenho escolar de um aluno\n\n    -   Unidade de medida: Percentual (%)\n\nSumário da base de dados:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nif (!require(skimr)) install.packages(\"skimr\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: skimr\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(skimr)\nskim(dados)\n```\n\n::: {.cell-output-display}\n\nTable: Data summary\n\n|                         |      |\n|:------------------------|:-----|\n|Name                     |dados |\n|Number of rows           |943   |\n|Number of columns        |9     |\n|_______________________  |      |\n|Column type frequency:   |      |\n|character                |2     |\n|numeric                  |7     |\n|________________________ |      |\n|Group variables          |None  |\n\n\n**Variable type: character**\n\n|skim_variable             | n_missing| complete_rate| min| max| empty| n_unique| whitespace|\n|:-------------------------|---------:|-------------:|---:|---:|-----:|--------:|----------:|\n|atividade_extracurricular |         0|             1|   3|   3|     0|        2|          0|\n|nivel_socioeconomico      |         0|             1|   4|   5|     0|        3|          0|\n\n\n**Variable type: numeric**\n\n|skim_variable    | n_missing| complete_rate|  mean|   sd|   p0|   p25|  p50|  p75|  p100|hist  |\n|:----------------|---------:|-------------:|-----:|----:|----:|-----:|----:|----:|-----:|:-----|\n|idade            |         0|          1.00| 16.03| 1.04| 13.0| 15.00| 16.0| 17.0|  19.0|▁▅▇▅▂ |\n|horas_estudo     |        10|          0.99| 15.14| 5.02| -0.2| 11.70| 15.2| 18.6|  32.0|▁▅▇▃▁ |\n|frequencia       |         0|          1.00| 87.30| 7.18| 75.0| 81.15| 87.4| 93.4| 100.0|▇▇▇▇▇ |\n|motivacao        |         0|          1.00| 17.03| 4.42|  4.5| 13.90| 16.9| 20.1|  30.3|▁▅▇▅▁ |\n|notas_anteriores |         8|          0.99|  7.02| 1.45|  1.4|  6.00|  7.0|  8.0|  12.3|▁▂▇▃▁ |\n|sono             |         0|          1.00|  6.98| 0.99|  4.1|  6.30|  7.0|  7.7|  10.1|▁▅▇▅▁ |\n|desempenho       |         0|          1.00| 31.06| 3.48| 21.3| 28.50| 31.1| 33.4|  40.5|▁▅▇▅▁ |\n\n\n:::\n:::\n\n\n\n### 2.1 Valores Ausentes\n\nCom base na tabela de análise exploratória gerada, podemos identificar que 8 observações da base de dados não possuem a variável notas anteriores. Além disso, também podemos verificar que a variável horas de estudo não está presente em 10 observações da base de dados.\n\nAssim sendo, é notório a necessidade de tratar as observações ausentes. Nesse contexto, uma boa estratégia para solucionar a ausência dessas observações é imputar valores como a mediana da respectiva variável nas observações em que ela está ausente pois é menos sensível a outliers.\n\n### 2.1 Potenciais Outliers\n\nOutro ponto importante observado na tabela de análise exploratória é a presença de possíveis outliers nas seguinte variávei:\n\n-   Horas de estudo: O valor mínimo observado é -0.2 (a unidade de medidas horas não pode ser negativa);\n\nPortanto, isso indica que potencialmente precisaremos tratar este caso substituindo o valor distoante observado por 0 ou removendo-o.\n\n## 3. Análise Bivariada\n\nNesta etapa iremos realizar uma análise entre a relação as variáveis (mais especificamente entre duas). Isto é importante pois permite identificarmos como as variáveis na base de dados influem uma na outra. Portanto, essa análise busca responder perguntas como:\n\n-   *Será que quanto mais horas de estudos possuir maior será seu desempenho/rendimento?*\n\nPor fim, é importante destacar que esse tipo de análise depende do tipo da variável estatística. Sendo assim, realizaremos uma análise para as variáveis quantitativas e uma outra para as variáveis categóricas (ou qualitativas).\n\n### 3.1 Análise Bivariada (Variáveis Numéricas)\n\nIniciamos a análise para as variáveis numéricas. Para fazer isso, utilizamos o seguinte código em R para gerar a matriz de correlação de tais variáveis:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nif (!require(dplyr)) install.packages(\"dplyr\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: dplyr\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'dplyr'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(dplyr)\n\n# Filtra os dados numéricos\ndados_numericos <- dados %>% select_if(is.numeric)\n# Gera matriz de correlação\ncorr_matrix <- cor(dados_numericos, use=\"complete.obs\")\n# Imprimindo matriz de correlação\ncorr_matrix\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                        idade horas_estudo   frequencia    motivacao\nidade             1.000000000  0.003809963 -0.025375870 -0.001900414\nhoras_estudo      0.003809963  1.000000000 -0.009137801  0.895871170\nfrequencia       -0.025375870 -0.009137801  1.000000000 -0.001685700\nmotivacao        -0.001900414  0.895871170 -0.001685700  1.000000000\nnotas_anteriores  0.024191432  0.001085386  0.040987491  0.023395068\nsono              0.013095813 -0.021474372 -0.005783914  0.005410990\ndesempenho       -0.006650054  0.371337708  0.625809456  0.272905989\n                 notas_anteriores         sono   desempenho\nidade                 0.024191432  0.013095813 -0.006650054\nhoras_estudo          0.001085386 -0.021474372  0.371337708\nfrequencia            0.040987491 -0.005783914  0.625809456\nmotivacao             0.023395068  0.005410990  0.272905989\nnotas_anteriores      1.000000000 -0.041963175  0.131835848\nsono                 -0.041963175  1.000000000 -0.125593182\ndesempenho            0.131835848 -0.125593182  1.000000000\n```\n\n\n:::\n:::\n\n\n\nUtilizando a biblioteca corrplot:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nif (!require(corrplot)) install.packages(\"corrplot\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: corrplot\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\ncorrplot 0.95 loaded\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(corrplot)\n\n# Plota a matriz de correlação das variáveis\ncorrplot(corr_matrix, method = \"color\", addCoef.col = \"black\")\n```\n\n::: {.cell-output-display}\n![](Projeto-Estatística_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\nA partir da matriz de correlação, podemos destacar as seguintes observações:\n\n1.  Existe indícios de uma **correlação forte positiva** (90%) entre horas de estudo e motivação. Isso implica que alunos motivados estudam mais. Além disso, a alta correlação indica que podemos simplificar o modelo de regressão linear simples pois ambas variáveis tendem a explicar de forma igual o rendimento acadêmico do aluno.\n\n2.  Frequência e desempenho acadêmicos possuem **correlação moderada positiva** (63%). Esses dados indicam que alunos que frequentam as aulas regularmente tendem a possuir um rendimento ou desempenho acadêmico melhor.\n\n3.  Horas de estudo e desempenho possuem **correlação baixa positiva** (37%). Isso indica que alunos que estudam mais, possuem um melhor desempenho acadêmico.\n\n4.  Desempenho e motivação **correlação baixa positiva** (27%). Isso indica que quanto mais motivado um aluno for, melhor será seu desempenho em suas atividades acadêmicas.\n\n5.  Desempenho e notas anteriores possuem **correlação baixa positiva** (13%). Logo, as notas de um aluno serão melhores se ele possuir um bom desempenho.\n\n6.  Sono e desempenho possuem **correlação baixa negativa** (13%). Portanto, é um indício de que alunos que dormem menos, tendem a ter um desempenho pior em seus estudos.\n\n### 3.2 Análise Bivariada (Variáveis Categóricas)\n\nAgora, partiremos para uma análise das variáveis numéricas em função das categóricas. Nesse contexto, plotaremos um gráfico boxplot que permite obter insights sobre como a variável desempenho se comporta em função de uma determinada variável categórica (i.e atividade extracurricular, etc.). Nele, podemos observar a mediana da variável categórica.\n\nInstalando package necessário:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Instala pacote necessário\nif (!require(ggpplot2)) install.packages(\"ggplot2\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: ggpplot2\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in library(package, lib.loc = lib.loc, character.only = TRUE,\nlogical.return = TRUE, : there is no package called 'ggpplot2'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nThe following package(s) will be installed:\n- ggplot2 [3.5.2]\nThese packages will be installed into \"~/Projeto Estatística/renv/library/macos/R-4.4/x86_64-apple-darwin20\".\n\n# Installing packages --------------------------------------------------------\n- Installing ggplot2 ...                        OK [linked from cache]\nSuccessfully installed 1 package in 13 milliseconds.\n```\n\n\n:::\n\n```{.r .cell-code}\n# Importa biblioteca ggplot2\nlibrary(ggplot2)\n```\n:::\n\n\n\nPrimeiro, analisamos para variável categórica atividade extracurricular. Vamos ver como o desempenho se comporta em função dessa variável categórica:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Plotando boxplot: desempenho acadêmico em função de atividade extracurricular\nggplot(dados, aes(x = atividade_extracurricular, y = desempenho)) +\n  geom_boxplot() + theme_minimal()\n```\n\n::: {.cell-output-display}\n![](Projeto-Estatística_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n**Conclusão**: Interpretando o gráfico plotado, é notório que alunos engajados em atividades extracurriculares possuem um melhor desempenho quando comparado a alunos que não participam de tais atividades. Logo, essa observação é estatisticamente evidente quando observamos a mediana dos dois boxes acima. Outro ponto importante a ser destacado é que podemos observar a presença de outliers (valores distoantes ou atípicos). Isso pode ser observado nos pontos mais extremos que ficam abaixo e acima dos boxes. Finalmente, isto indica que de fato há uma correlação entre as duas váriaveis.\n\nAgora analisaremos o gráfico da variável categórica denominada nível socioeconômico:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Plotando boxplot: desempenho acadêmico em função do nível socioeconômico\nggplot(dados, aes(x = nivel_socioeconomico, y = desempenho)) + geom_boxplot() + theme_minimal()\n```\n\n::: {.cell-output-display}\n![](Projeto-Estatística_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n**Conclusão**: Analisando o gráfico acima, podemos observar que diferentes níveis socioeconômicos não impactam no desempenho acadêmico de um aluno. Em outras palavras, apesar de haver uma leve diferença nas medianas dos boxplot, essa diferença é mínima ou desprezível quando analisamos estatisticamente. Além disso, assim como na análise anterior, também podemos notar a presença de outliers nesse gráfico. Por fim, podemos concluir que não há uma correlação, ou seja, que estatisticamente falando, o nível socioeconômico de um aluno não impacta em seu desempenho educacional.\n\n## 4. Análise de Regressão\n\nNesta seção, será realizada uma **análise de regressão linear múltipla** com o objetivo de investigar a influência de diversas variáveis explicativas sobre a resposta `desempenho`. Essa abordagem permite quantificar a relação entre o desemepenho acadêmico e os demais fatores que vimos anteriormente (atividades extracurriculares, nível socioeconômico, etc.).\n\nNesse contexto, iremos realizar as seguintes investigações:\n\n-   Diagnóstico de multicolinearidade;\n\n-   Avaliar a significância estatística das variáveis no contexto do modelo;\n\n-   Verificar a capacidade preditiva do modelo por meio do coeficiente de determinação (R²);\n\n-   Análisar resíduos.\n\n### 4.1 Análise da Significância Estatitística das Variáveis\n\nAssim sendo, iniciaremos a análise implementando o nosso modelo e gerando um sumário estatístico. Através desse sumário, poderemos, por exemplo, avaliar a significância estatística das variáveis.\n\nCriando o modelo de regressão linear e exibindo um sumário:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Criando modelo de regressão linear\nmodelo <- lm(desempenho ~ idade + horas_estudo + frequencia + atividade_extracurricular + nivel_socioeconomico + motivacao + notas_anteriores + sono + desempenho, data = dados)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in model.matrix.default(mt, mf, contrasts): the response appeared on\nthe right-hand side and was dropped\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in model.matrix.default(mt, mf, contrasts): problem with term 9 in\nmodel.matrix: no columns are assigned\n```\n\n\n:::\n\n```{.r .cell-code}\n# Exibindo resultados\nsummary(modelo)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = desempenho ~ idade + horas_estudo + frequencia + \n    atividade_extracurricular + nivel_socioeconomico + motivacao + \n    notas_anteriores + sono + desempenho, data = dados)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-7.2374 -1.3748 -0.1003  1.4228  6.0523 \n\nCoefficients:\n                              Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                   1.676967   1.442204   1.163    0.245    \nidade                         0.035082   0.063316   0.554    0.580    \nhoras_estudo                  0.476040   0.029477  16.149  < 2e-16 ***\nfrequencia                    0.300170   0.009151  32.803  < 2e-16 ***\natividade_extracurricularSim  2.230537   0.135026  16.519  < 2e-16 ***\nnivel_socioeconomicoBaixo     0.207329   0.191807   1.081    0.280    \nnivel_socioeconomicoMédio     0.240386   0.174924   1.374    0.170    \nmotivacao                    -0.271728   0.033495  -8.112 1.59e-15 ***\nnotas_anteriores              0.219761   0.045138   4.869 1.32e-06 ***\nsono                         -0.366070   0.066055  -5.542 3.91e-08 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.992 on 915 degrees of freedom\n  (18 observations deleted due to missingness)\nMultiple R-squared:  0.675,\tAdjusted R-squared:  0.6718 \nF-statistic: 211.1 on 9 and 915 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n:::\n\n\n\n**Interpretação**: Considerando um **nível de significância de 5% (α = 0.05),** os dados do modelo de **regressão linear múltipla** e sabendo que as variáveis que são estaticamente significativas para o modelo são aquelas com **p-valor \\< 0.05,** podemos concluir que as seguintes variáveis tem um efeito estatisticamente significativo para explicar o **desempenho do aluno**:\n\n| Variável | Coef. Estimado | Interpretação |\n|:-------------------------:|:---------------:|:-------------------------:|\n| `horas_estudo` | 0.476 | A cada hora de estudo, o desempenho do aluno aumenta em 47.6%. |\n| `frequencia` | 0.300 | A cada frequência/presença do aluno nas aulas, seu desempenho aumenta em 30%. |\n| `atividade_extracurricularSim` | 2.230 | Alunos que participam de atividades extracurriculares apresenta um desempenho 2.23 maior em relação a alunos que não participam de atividades extracurriculares. |\n| `motivacao` | -0.271 | Alunos que são mais motivados tendem a possuir um desempenho menor, contudo, isto é indicativo de multicolinearidade, pois em nossa análise anterior, vimos que alunos com motivação maior possuem na realidade um melhor desempenho que alunos menos motivados. |\n| `notas_anteriores` | 0.219 | Alunos que possuem notas anteiores melhores possuem um desempenho de 21.9% melhor em relação a alunos com notas anteriores piores. |\n| `sono` | -0.366 | Mais sono está associado a menor desempenho. (Isso pode indicar noites mais longas de sono em vez de tempo ideal de descanso.) |\n\nPor fim, as seguintes variáveis não possuem um efeito estatisticamente significativo para explicar o desempenho do aluno **(p-valor \\> 0.05):**\n\n|          Variável           | p-valor |\n|:---------------------------:|:-------:|\n|           `idade`           |  0.580  |\n| `nivel_socioeconomicoBaixo` |  0.207  |\n| `nivel_socioeconomicoMedio` |  0.170  |\n\n**Observação**: a variável `nivel_socioeconomico` é categórica. Isso significa que ela está sendo comparada a uma classe referência. No nosso caso a referência é `nivel_socioeconomicoAlto` . Como nenhuma das classes não possui um efeito estatisticamente significativo, podemos desconsiderá-la.\n\n### 4.2 Diagnóstico de Multicolinearidade\n\nConforme observamos na análise da significância, o coeficiente estimado da variável `motivacao` resultou em um valog negativo, porém, não faz sentido, pois alunos mais motivados tendem a ter um melhor desempenho. Quando inconsistências assim ocorrem em nossa análise isso pode nos indicar que há uma **multicolinearidade** entre duas ou mais variáveis.\n\nUm dos objetivos da análise de regressão é analisar de maneira isolada a relação entre a variável de interesse (no nosso caso `desempenho`) e as demais variáveis (`idade`, `notas_anteriores`, etc.). Nesse contexto, quando duas ou mais variáveis são altamente correlacionadas fica difícil de estimar a correlação entre as variáveis de forma independente. Este problema é chamado de **multicolinearidade.**\n\nA fim de investigar se há multicolinearidade ou não em nosso modelo, utilizaremos a medida estatística conhecida como **Variance Inflation Factor (VIF).** A VIF começa com o valor 1 e não possuí um limite superior. De forma resumida ela funciona da seguinte maneira:\n\n-   VIF = 1 Indica que não há multicolinearidade;\n\n-   1 \\< VIF \\<= 5 indica que há uma correlação moderada\n\n-   VIF \\> 5 indica que há uma forte correlação\n\nCalculando o valor da medida estatística VIF:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nif (require(car)) install.packages(\"car\")  # pacote que possui a função vif\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: car\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: carData\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'car'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following object is masked from 'package:dplyr':\n\n    recode\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nThe following package(s) will be installed:\n- car [3.1-3]\nThese packages will be installed into \"~/Projeto Estatística/renv/library/macos/R-4.4/x86_64-apple-darwin20\".\n\n# Installing packages --------------------------------------------------------\n- Installing car ...                            OK [linked from cache]\nSuccessfully installed 1 package in 8.6 milliseconds.\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(car)\n# Imprimindo medida estatística vif para o nosso modelo\nvif(modelo) \n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in model.matrix.default(mod, data = structure(list(desempenho = c(29.7,\n: the response appeared on the right-hand side and was dropped\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in model.matrix.default(mod, data = structure(list(desempenho = c(29.7,\n: problem with term 9 in model.matrix: no columns are assigned\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                              GVIF Df GVIF^(1/(2*Df))\nidade                     1.003597  1        1.001797\nhoras_estudo              5.115839  1        2.261822\nfrequencia                1.004422  1        1.002208\natividade_extracurricular 1.008862  1        1.004421\nnivel_socioeconomico      1.013332  2        1.003316\nmotivacao                 5.109902  1        2.260509\nnotas_anteriores          1.009673  1        1.004825\nsono                      1.009262  1        1.004620\ndesempenho                9.283433  0             Inf\n```\n\n\n:::\n:::\n\n\n\nObserva-se que:\n\n-   `motivacao`: VIF \\> 5\n\n-   `horas_estudo`: VIF \\> 5\n\nPortanto, há um forte indício de multicolinearidade entre as duas variáveis, ou seja, elas são altamente correlacionados.\n\n## 5. Seleção do Modelo\n\nFeito a análise bivariada, análise de regressão e diagnóstico de multicolinearidade do modelo, nesta etapa iremos realizar a seleção do modelo utilizando os resultados observáveis nas análises anteriores para decidir quais variáveis utilizar, etc. No final desta etapa, o objetivo é termos um modelo de regressão linear múltipla mais simples e adequado para o nosso propósito.\n\nIniciaremos nossa seleção atulizando o modelo com o objetivo de retirar as variáveis não significativas. Após isso, utilizaremos medidas estatísticas para comparar os modelos e selecionar o mais adequado.\n\nSegue o sumário do modelo inicial para referência das variáveis significativas e não significativas:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(modelo)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = desempenho ~ idade + horas_estudo + frequencia + \n    atividade_extracurricular + nivel_socioeconomico + motivacao + \n    notas_anteriores + sono + desempenho, data = dados)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-7.2374 -1.3748 -0.1003  1.4228  6.0523 \n\nCoefficients:\n                              Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                   1.676967   1.442204   1.163    0.245    \nidade                         0.035082   0.063316   0.554    0.580    \nhoras_estudo                  0.476040   0.029477  16.149  < 2e-16 ***\nfrequencia                    0.300170   0.009151  32.803  < 2e-16 ***\natividade_extracurricularSim  2.230537   0.135026  16.519  < 2e-16 ***\nnivel_socioeconomicoBaixo     0.207329   0.191807   1.081    0.280    \nnivel_socioeconomicoMédio     0.240386   0.174924   1.374    0.170    \nmotivacao                    -0.271728   0.033495  -8.112 1.59e-15 ***\nnotas_anteriores              0.219761   0.045138   4.869 1.32e-06 ***\nsono                         -0.366070   0.066055  -5.542 3.91e-08 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.992 on 915 degrees of freedom\n  (18 observations deleted due to missingness)\nMultiple R-squared:  0.675,\tAdjusted R-squared:  0.6718 \nF-statistic: 211.1 on 9 and 915 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n:::\n\n\n\n### 5.1 Remoção das Variáveis Não Significativas\n\nPrimeiramente, removeremos as variáveis não significativas `idade` e `nivel_socioeconomico` :\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Removendo idade\nmodelo_sem_idade <- update(modelo, . ~ . - idade)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in model.matrix.default(mt, mf, contrasts): the response appeared on\nthe right-hand side and was dropped\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in model.matrix.default(mt, mf, contrasts): problem with term 8 in\nmodel.matrix: no columns are assigned\n```\n\n\n:::\n\n```{.r .cell-code}\n# Removendo nivel_socioeconomico\nmodelo_simplificado <- update(modelo_sem_idade, . ~ . - nivel_socioeconomico)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in model.matrix.default(mt, mf, contrasts): the response appeared on\nthe right-hand side and was dropped\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in model.matrix.default(mt, mf, contrasts): problem with term 7 in\nmodel.matrix: no columns are assigned\n```\n\n\n:::\n\n```{.r .cell-code}\n# Sumario do modelo simplificado\nsummary(modelo_simplificado)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = desempenho ~ horas_estudo + frequencia + atividade_extracurricular + \n    motivacao + notas_anteriores + sono + desempenho, data = dados)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-7.1448 -1.4077 -0.0889  1.4418  6.0996 \n\nCoefficients:\n                              Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                   2.416665   1.002754   2.410   0.0161 *  \nhoras_estudo                  0.474304   0.029422  16.121  < 2e-16 ***\nfrequencia                    0.300280   0.009138  32.862  < 2e-16 ***\natividade_extracurricularSim  2.222924   0.134679  16.505  < 2e-16 ***\nmotivacao                    -0.270154   0.033451  -8.076 2.09e-15 ***\nnotas_anteriores              0.220588   0.045102   4.891 1.19e-06 ***\nsono                         -0.366958   0.065913  -5.567 3.40e-08 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.992 on 918 degrees of freedom\n  (18 observations deleted due to missingness)\nMultiple R-squared:  0.6742,\tAdjusted R-squared:  0.672 \nF-statistic: 316.6 on 6 and 918 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n:::\n\n\n\nComparando AIC do `modelo_simplificado` e do `modelo` completo:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nAIC(modelo)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 3912.297\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nAIC(modelo_simplificado) # sem idade e nivel socioeconomico\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 3908.553\n```\n\n\n:::\n:::\n\n\n\nNota-se que o `modelo_completo` possui um AIC menor que o `modelo` inicial. Outra medida que podemos utilizar para comparar é a **Critério de Informação Bayesiano (BIC).** O modelo que apresentar a menor BIC são preferidos, pois apresentam melhor ajuste aos dados com número menor de parâmetros.\n\nComparando BIC do `modelo_simplificado` e do `modelo` completo:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nBIC(modelo)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 3965.425\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nBIC(modelo_simplificado)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 3947.192\n```\n\n\n:::\n:::\n\n\n\nIsso confirma que o `modelo_simplificado` está mais ajustado e adequado para nossos propósitos.\n\n### 5.2 Motivação ou Horas de Estudo? Resolvendo O Grande Elefante Branco na Sala: Multicolinearidade\n\nFinalmente, é hora de resolvermos a multicolinearidade. Para resolver este problema, utilizaremos a mesma abordagem acima. Atualizaremos o modelo manualmente e, através dos critérios estatísticos AIC e BIC, escolheremos a variável que mais ajuda a explicar o desempenho do estudante. Para isso, precisamos relembrar que as variáveis causadoras desse problema são: `motivacao` e `horas_estudo` .\n\nRemovendo `motivacao` do `modelo_simplificado` :\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodelo_sem_motivacao <- update(modelo_simplificado, . ~ . - motivacao)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in model.matrix.default(mt, mf, contrasts): the response appeared on\nthe right-hand side and was dropped\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in model.matrix.default(mt, mf, contrasts): problem with term 6 in\nmodel.matrix: no columns are assigned\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(modelo_sem_motivacao)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = desempenho ~ horas_estudo + frequencia + atividade_extracurricular + \n    notas_anteriores + sono + desempenho, data = dados)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-7.0186 -1.4246 -0.0734  1.4258  5.9407 \n\nCoefficients:\n                              Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                   1.475033   1.030165   1.432    0.153    \nhoras_estudo                  0.261267   0.013479  19.383  < 2e-16 ***\nfrequencia                    0.299376   0.009451  31.677  < 2e-16 ***\natividade_extracurricularSim  2.191061   0.139245  15.735  < 2e-16 ***\nnotas_anteriores              0.202104   0.046592   4.338 1.60e-05 ***\nsono                         -0.397516   0.068065  -5.840 7.23e-09 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.06 on 919 degrees of freedom\n  (18 observations deleted due to missingness)\nMultiple R-squared:  0.651,\tAdjusted R-squared:  0.6491 \nF-statistic: 342.9 on 5 and 919 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n:::\n\n\n\nRemovendo `horas_estudo` do `modelo_simplificado` :\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodelo_sem_horas_estudo <- update(modelo_simplificado, . ~ . - horas_estudo)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in model.matrix.default(mt, mf, contrasts): the response appeared on\nthe right-hand side and was dropped\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in model.matrix.default(mt, mf, contrasts): problem with term 6 in\nmodel.matrix: no columns are assigned\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(modelo_sem_horas_estudo)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = desempenho ~ frequencia + atividade_extracurricular + \n    motivacao + notas_anteriores + sono + desempenho, data = dados)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-6.4150 -1.4878 -0.0289  1.4296  6.7518 \n\nCoefficients:\n                             Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                   2.35316    1.12327   2.095 0.036447 *  \nfrequencia                    0.29731    0.01027  28.947  < 2e-16 ***\natividade_extracurricularSim  2.16381    0.15126  14.305  < 2e-16 ***\nmotivacao                     0.21151    0.01666  12.693  < 2e-16 ***\nnotas_anteriores              0.18894    0.05086   3.715 0.000216 ***\nsono                         -0.43250    0.07405  -5.841 7.19e-09 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.252 on 929 degrees of freedom\n  (8 observations deleted due to missingness)\nMultiple R-squared:  0.5813,\tAdjusted R-squared:  0.5791 \nF-statistic:   258 on 5 and 929 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n:::\n\n\n\nComparando os dois modelos com as medidas **AIC** e **BIC:**\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nAIC(modelo_sem_motivacao)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 3970.044\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nAIC(modelo_sem_horas_estudo)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 4179.175\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nBIC(modelo_sem_motivacao)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 4003.853\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nBIC(modelo_sem_horas_estudo)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 4213.059\n```\n\n\n:::\n:::\n\n\n\nNota-se, através da análise realizada, que o modelo mais adequado e ajustado é aquele sem a variável `motivacao` e com a variável `horas_estudo.`, ou seja, o `modelo_sem_motivacao`.\n",
    "supporting": [
      "Projeto-Estatística_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}