<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Projeto Estatística</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Projeto Estatística_files/libs/clipboard/clipboard.min.js"></script>
<script src="Projeto Estatística_files/libs/quarto-html/quarto.js"></script>
<script src="Projeto Estatística_files/libs/quarto-html/popper.min.js"></script>
<script src="Projeto Estatística_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Projeto Estatística_files/libs/quarto-html/anchor.min.js"></script>
<link href="Projeto Estatística_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Projeto Estatística_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Projeto Estatística_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Projeto Estatística_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Projeto Estatística_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introdução" id="toc-introdução" class="nav-link active" data-scroll-target="#introdução">1. Introdução</a></li>
  <li><a href="#a-base-de-dados" id="toc-a-base-de-dados" class="nav-link" data-scroll-target="#a-base-de-dados">2. A Base de Dados</a>
  <ul class="collapse">
  <li><a href="#valores-ausentes" id="toc-valores-ausentes" class="nav-link" data-scroll-target="#valores-ausentes">2.1 Valores Ausentes</a></li>
  <li><a href="#potenciais-outliers" id="toc-potenciais-outliers" class="nav-link" data-scroll-target="#potenciais-outliers">2.1 Potenciais Outliers</a></li>
  </ul></li>
  <li><a href="#análise-bivariada" id="toc-análise-bivariada" class="nav-link" data-scroll-target="#análise-bivariada">3. Análise Bivariada</a>
  <ul class="collapse">
  <li><a href="#análise-bivariada-variáveis-numéricas" id="toc-análise-bivariada-variáveis-numéricas" class="nav-link" data-scroll-target="#análise-bivariada-variáveis-numéricas">3.1 Análise Bivariada (Variáveis Numéricas)</a></li>
  <li><a href="#análise-bivariada-variáveis-categóricas" id="toc-análise-bivariada-variáveis-categóricas" class="nav-link" data-scroll-target="#análise-bivariada-variáveis-categóricas">3.2 Análise Bivariada (Variáveis Categóricas)</a></li>
  </ul></li>
  <li><a href="#análise-de-regressão" id="toc-análise-de-regressão" class="nav-link" data-scroll-target="#análise-de-regressão">4. Análise de Regressão</a>
  <ul class="collapse">
  <li><a href="#análise-da-significância-estatitística-das-variáveis" id="toc-análise-da-significância-estatitística-das-variáveis" class="nav-link" data-scroll-target="#análise-da-significância-estatitística-das-variáveis">4.1 Análise da Significância Estatitística das Variáveis</a></li>
  <li><a href="#diagnóstico-de-multicolinearidade" id="toc-diagnóstico-de-multicolinearidade" class="nav-link" data-scroll-target="#diagnóstico-de-multicolinearidade">4.2 Diagnóstico de Multicolinearidade</a></li>
  </ul></li>
  <li><a href="#seleção-do-modelo" id="toc-seleção-do-modelo" class="nav-link" data-scroll-target="#seleção-do-modelo">5. Seleção do Modelo</a>
  <ul class="collapse">
  <li><a href="#remoção-das-variáveis-não-significativas" id="toc-remoção-das-variáveis-não-significativas" class="nav-link" data-scroll-target="#remoção-das-variáveis-não-significativas">5.1 Remoção das Variáveis Não Significativas</a></li>
  <li><a href="#motivação-ou-horas-de-estudo-resolvendo-o-grande-elefante-branco-na-sala-multicolinearidade" id="toc-motivação-ou-horas-de-estudo-resolvendo-o-grande-elefante-branco-na-sala-multicolinearidade" class="nav-link" data-scroll-target="#motivação-ou-horas-de-estudo-resolvendo-o-grande-elefante-branco-na-sala-multicolinearidade">5.2 Motivação ou Horas de Estudo? Resolvendo O Grande Elefante Branco na Sala: Multicolinearidade</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Projeto Estatística</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="introdução" class="level2">
<h2 class="anchored" data-anchor-id="introdução">1. Introdução</h2>
<p>Neste projeto, será realizado uma análise estatística com o objetivo de investigar possíveis relações entre fatores, como, por exemplo, idade, horas de estudo, e como impactam o desempenho acadêmico de um estudante.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Instala biblioteca caso necessário </span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(readxl)) <span class="fu">install.packages</span>(<span class="st">"readxl"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: readxl</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Importando biblioteca para ler arquivo .xslx </span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr) </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Lendo base de dados </span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"base_de_dados.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="a-base-de-dados" class="level2">
<h2 class="anchored" data-anchor-id="a-base-de-dados">2. A Base de Dados</h2>
<p>A base de dados é composta por 943 observações e 9 variáveis, cada uma representando uma característica ou comportamento relacionado ao desempenho escolar. Abaixo estão listadas as variáveis investigadas, seus significados e respectivas unidades de medida:</p>
<ol type="1">
<li><p>Idade</p>
<ul>
<li><p>Tipo: Quantitativa</p></li>
<li><p>Descrição: Indica a idade do aluno</p></li>
<li><p>Unidade de medida: Anos</p></li>
</ul></li>
<li><p>Horas de estudos</p>
<ul>
<li><p>Tipo: Quantitativa</p></li>
<li><p>Descrição: Indica o tempo total de estudo de um aluno</p></li>
<li><p>Unidade de medida: Horas</p></li>
</ul></li>
<li><p>Frequência</p>
<ul>
<li><p>Tipo: Quantitativa</p></li>
<li><p>Descrição: Representa a frequência do aluno nas aulas</p></li>
<li><p>Unidade de Medida: Percentual (%)</p></li>
</ul></li>
<li><p>Atividades extracurriculares</p>
<ul>
<li><p>Tipo: Categórica</p></li>
<li><p>Descrição: Indica se o aluno participa de atividades extracurriculares</p></li>
<li><p>Unidade de medida: Pode ser Sim/Não</p></li>
</ul></li>
<li><p>Nível socioeconômico</p>
<ul>
<li><p>Tipo: Categórica</p></li>
<li><p>Descrição: Representa a condição econômica e social do aluno</p></li>
<li><p>Unidade de medida: Pode ser Alto/Médio/Baixo</p></li>
</ul></li>
<li><p>Motivação</p>
<ul>
<li><p>Tipo: Quantitativa</p></li>
<li><p>Descrição: Mede o nível de motivação do aluno em relação aos estudos</p></li>
<li><p>Unidade de medida: Percentual (%)</p></li>
</ul></li>
<li><p>Notas anteriores</p>
<ul>
<li><p>Tipo: Quantitativa</p></li>
<li><p>Descrição: Refere-se ao desempenho escolar (média) de um aluno em avaliações escolares</p></li>
<li><p>Unidade de medida: Nota numérica (de 0 a 10)</p></li>
</ul></li>
<li><p>Sono</p>
<ul>
<li><p>Tipo: Quantitativa</p></li>
<li><p>Descrição: Indica o tempo médio de sono diário de um aluno</p></li>
<li><p>Unidade de medida: Horas</p></li>
</ul></li>
<li><p>Desempenho</p>
<ul>
<li><p>Tipo: Quantitativa</p></li>
<li><p>Descrição: Refere-se ao desempenho escolar de um aluno</p></li>
<li><p>Unidade de medida: Percentual (%)</p></li>
</ul></li>
</ol>
<p>Sumário da base de dados:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(skimr)) <span class="fu">install.packages</span>(<span class="st">"skimr"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: skimr</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(skimr)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">skim</span>(dados)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">dados</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">943</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">9</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">character</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">7</td>
</tr>
<tr class="even">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 30%">
<col style="width: 11%">
<col style="width: 16%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 7%">
<col style="width: 10%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">atividade_extracurricular</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">nivel_socioeconomico</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 20%">
<col style="width: 11%">
<col style="width: 16%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">idade</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">16.03</td>
<td style="text-align: right;">1.04</td>
<td style="text-align: right;">13.0</td>
<td style="text-align: right;">15.00</td>
<td style="text-align: right;">16.0</td>
<td style="text-align: right;">17.0</td>
<td style="text-align: right;">19.0</td>
<td style="text-align: left;">▁▅▇▅▂</td>
</tr>
<tr class="even">
<td style="text-align: left;">horas_estudo</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">15.14</td>
<td style="text-align: right;">5.02</td>
<td style="text-align: right;">-0.2</td>
<td style="text-align: right;">11.70</td>
<td style="text-align: right;">15.2</td>
<td style="text-align: right;">18.6</td>
<td style="text-align: right;">32.0</td>
<td style="text-align: left;">▁▅▇▃▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">frequencia</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">87.30</td>
<td style="text-align: right;">7.18</td>
<td style="text-align: right;">75.0</td>
<td style="text-align: right;">81.15</td>
<td style="text-align: right;">87.4</td>
<td style="text-align: right;">93.4</td>
<td style="text-align: right;">100.0</td>
<td style="text-align: left;">▇▇▇▇▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">motivacao</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">17.03</td>
<td style="text-align: right;">4.42</td>
<td style="text-align: right;">4.5</td>
<td style="text-align: right;">13.90</td>
<td style="text-align: right;">16.9</td>
<td style="text-align: right;">20.1</td>
<td style="text-align: right;">30.3</td>
<td style="text-align: left;">▁▅▇▅▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">notas_anteriores</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">7.02</td>
<td style="text-align: right;">1.45</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: right;">6.00</td>
<td style="text-align: right;">7.0</td>
<td style="text-align: right;">8.0</td>
<td style="text-align: right;">12.3</td>
<td style="text-align: left;">▁▂▇▃▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">sono</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">6.98</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">4.1</td>
<td style="text-align: right;">6.30</td>
<td style="text-align: right;">7.0</td>
<td style="text-align: right;">7.7</td>
<td style="text-align: right;">10.1</td>
<td style="text-align: left;">▁▅▇▅▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">desempenho</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">31.06</td>
<td style="text-align: right;">3.48</td>
<td style="text-align: right;">21.3</td>
<td style="text-align: right;">28.50</td>
<td style="text-align: right;">31.1</td>
<td style="text-align: right;">33.4</td>
<td style="text-align: right;">40.5</td>
<td style="text-align: left;">▁▅▇▅▁</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="valores-ausentes" class="level3">
<h3 class="anchored" data-anchor-id="valores-ausentes">2.1 Valores Ausentes</h3>
<p>Com base na tabela de análise exploratória gerada, podemos identificar que 8 observações da base de dados não possuem a variável notas anteriores. Além disso, também podemos verificar que a variável horas de estudo não está presente em 10 observações da base de dados.</p>
<p>Assim sendo, é notório a necessidade de tratar as observações ausentes. Nesse contexto, uma boa estratégia para solucionar a ausência dessas observações é imputar valores como a mediana da respectiva variável nas observações em que ela está ausente pois é menos sensível a outliers.</p>
</section>
<section id="potenciais-outliers" class="level3">
<h3 class="anchored" data-anchor-id="potenciais-outliers">2.1 Potenciais Outliers</h3>
<p>Outro ponto importante observado na tabela de análise exploratória é a presença de possíveis outliers nas seguinte variávei:</p>
<ul>
<li>Horas de estudo: O valor mínimo observado é -0.2 (a unidade de medidas horas não pode ser negativa);</li>
</ul>
<p>Portanto, isso indica que potencialmente precisaremos tratar este caso substituindo o valor distoante observado por 0 ou removendo-o.</p>
</section>
</section>
<section id="análise-bivariada" class="level2">
<h2 class="anchored" data-anchor-id="análise-bivariada">3. Análise Bivariada</h2>
<p>Nesta etapa iremos realizar uma análise entre a relação as variáveis (mais especificamente entre duas). Isto é importante pois permite identificarmos como as variáveis na base de dados influem uma na outra. Portanto, essa análise busca responder perguntas como:</p>
<ul>
<li><em>Será que quanto mais horas de estudos possuir maior será seu desempenho/rendimento?</em></li>
</ul>
<p>Por fim, é importante destacar que esse tipo de análise depende do tipo da variável estatística. Sendo assim, realizaremos uma análise para as variáveis quantitativas e uma outra para as variáveis categóricas (ou qualitativas).</p>
<section id="análise-bivariada-variáveis-numéricas" class="level3">
<h3 class="anchored" data-anchor-id="análise-bivariada-variáveis-numéricas">3.1 Análise Bivariada (Variáveis Numéricas)</h3>
<p>Iniciamos a análise para as variáveis numéricas. Para fazer isso, utilizamos o seguinte código em R para gerar a matriz de correlação de tais variáveis:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(dplyr)) <span class="fu">install.packages</span>(<span class="st">"dplyr"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: dplyr</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtra os dados numéricos</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>dados_numericos <span class="ot">&lt;-</span> dados <span class="sc">%&gt;%</span> <span class="fu">select_if</span>(is.numeric)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Gera matriz de correlação</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>corr_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(dados_numericos, <span class="at">use=</span><span class="st">"complete.obs"</span>)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Imprimindo matriz de correlação</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>corr_matrix</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        idade horas_estudo   frequencia    motivacao
idade             1.000000000  0.003809963 -0.025375870 -0.001900414
horas_estudo      0.003809963  1.000000000 -0.009137801  0.895871170
frequencia       -0.025375870 -0.009137801  1.000000000 -0.001685700
motivacao        -0.001900414  0.895871170 -0.001685700  1.000000000
notas_anteriores  0.024191432  0.001085386  0.040987491  0.023395068
sono              0.013095813 -0.021474372 -0.005783914  0.005410990
desempenho       -0.006650054  0.371337708  0.625809456  0.272905989
                 notas_anteriores         sono   desempenho
idade                 0.024191432  0.013095813 -0.006650054
horas_estudo          0.001085386 -0.021474372  0.371337708
frequencia            0.040987491 -0.005783914  0.625809456
motivacao             0.023395068  0.005410990  0.272905989
notas_anteriores      1.000000000 -0.041963175  0.131835848
sono                 -0.041963175  1.000000000 -0.125593182
desempenho            0.131835848 -0.125593182  1.000000000</code></pre>
</div>
</div>
<p>Utilizando a biblioteca corrplot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(corrplot)) <span class="fu">install.packages</span>(<span class="st">"corrplot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: corrplot</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>corrplot 0.95 loaded</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Plota a matriz de correlação das variáveis</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(corr_matrix, <span class="at">method =</span> <span class="st">"color"</span>, <span class="at">addCoef.col =</span> <span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Projeto-Estatística_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>A partir da matriz de correlação, podemos destacar as seguintes observações:</p>
<ol type="1">
<li><p>Existe indícios de uma <strong>correlação forte positiva</strong> (90%) entre horas de estudo e motivação. Isso implica que alunos motivados estudam mais. Além disso, a alta correlação indica que podemos simplificar o modelo de regressão linear simples pois ambas variáveis tendem a explicar de forma igual o rendimento acadêmico do aluno.</p></li>
<li><p>Frequência e desempenho acadêmicos possuem <strong>correlação moderada positiva</strong> (63%). Esses dados indicam que alunos que frequentam as aulas regularmente tendem a possuir um rendimento ou desempenho acadêmico melhor.</p></li>
<li><p>Horas de estudo e desempenho possuem <strong>correlação baixa positiva</strong> (37%). Isso indica que alunos que estudam mais, possuem um melhor desempenho acadêmico.</p></li>
<li><p>Desempenho e motivação <strong>correlação baixa positiva</strong> (27%). Isso indica que quanto mais motivado um aluno for, melhor será seu desempenho em suas atividades acadêmicas.</p></li>
<li><p>Desempenho e notas anteriores possuem <strong>correlação baixa positiva</strong> (13%). Logo, as notas de um aluno serão melhores se ele possuir um bom desempenho.</p></li>
<li><p>Sono e desempenho possuem <strong>correlação baixa negativa</strong> (13%). Portanto, é um indício de que alunos que dormem menos, tendem a ter um desempenho pior em seus estudos.</p></li>
</ol>
</section>
<section id="análise-bivariada-variáveis-categóricas" class="level3">
<h3 class="anchored" data-anchor-id="análise-bivariada-variáveis-categóricas">3.2 Análise Bivariada (Variáveis Categóricas)</h3>
<p>Agora, partiremos para uma análise das variáveis numéricas em função das categóricas. Nesse contexto, plotaremos um gráfico boxplot que permite obter insights sobre como a variável desempenho se comporta em função de uma determinada variável categórica (i.e atividade extracurricular, etc.). Nele, podemos observar a mediana da variável categórica.</p>
<p>Instalando package necessário:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Instala pacote necessário</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(ggpplot2)) <span class="fu">install.packages</span>(<span class="st">"ggplot2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ggpplot2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in library(package, lib.loc = lib.loc, character.only = TRUE,
logical.return = TRUE, : there is no package called 'ggpplot2'</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>The following package(s) will be installed:
- ggplot2 [3.5.2]
These packages will be installed into "~/Projeto Estatística/renv/library/macos/R-4.4/x86_64-apple-darwin20".

# Installing packages --------------------------------------------------------
- Installing ggplot2 ...                        OK [linked from cache]
Successfully installed 1 package in 13 milliseconds.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Importa biblioteca ggplot2</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Primeiro, analisamos para variável categórica atividade extracurricular. Vamos ver como o desempenho se comporta em função dessa variável categórica:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotando boxplot: desempenho acadêmico em função de atividade extracurricular</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dados, <span class="fu">aes</span>(<span class="at">x =</span> atividade_extracurricular, <span class="at">y =</span> desempenho)) <span class="sc">+</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Projeto-Estatística_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Conclusão</strong>: Interpretando o gráfico plotado, é notório que alunos engajados em atividades extracurriculares possuem um melhor desempenho quando comparado a alunos que não participam de tais atividades. Logo, essa observação é estatisticamente evidente quando observamos a mediana dos dois boxes acima. Outro ponto importante a ser destacado é que podemos observar a presença de outliers (valores distoantes ou atípicos). Isso pode ser observado nos pontos mais extremos que ficam abaixo e acima dos boxes. Finalmente, isto indica que de fato há uma correlação entre as duas váriaveis.</p>
<p>Agora analisaremos o gráfico da variável categórica denominada nível socioeconômico:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotando boxplot: desempenho acadêmico em função do nível socioeconômico</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dados, <span class="fu">aes</span>(<span class="at">x =</span> nivel_socioeconomico, <span class="at">y =</span> desempenho)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>() <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Projeto-Estatística_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Conclusão</strong>: Analisando o gráfico acima, podemos observar que diferentes níveis socioeconômicos não impactam no desempenho acadêmico de um aluno. Em outras palavras, apesar de haver uma leve diferença nas medianas dos boxplot, essa diferença é mínima ou desprezível quando analisamos estatisticamente. Além disso, assim como na análise anterior, também podemos notar a presença de outliers nesse gráfico. Por fim, podemos concluir que não há uma correlação, ou seja, que estatisticamente falando, o nível socioeconômico de um aluno não impacta em seu desempenho educacional.</p>
</section>
</section>
<section id="análise-de-regressão" class="level2">
<h2 class="anchored" data-anchor-id="análise-de-regressão">4. Análise de Regressão</h2>
<p>Nesta seção, será realizada uma <strong>análise de regressão linear múltipla</strong> com o objetivo de investigar a influência de diversas variáveis explicativas sobre a resposta <code>desempenho</code>. Essa abordagem permite quantificar a relação entre o desemepenho acadêmico e os demais fatores que vimos anteriormente (atividades extracurriculares, nível socioeconômico, etc.).</p>
<p>Nesse contexto, iremos realizar as seguintes investigações:</p>
<ul>
<li><p>Diagnóstico de multicolinearidade;</p></li>
<li><p>Avaliar a significância estatística das variáveis no contexto do modelo;</p></li>
<li><p>Verificar a capacidade preditiva do modelo por meio do coeficiente de determinação (R²);</p></li>
<li><p>Análisar resíduos.</p></li>
</ul>
<section id="análise-da-significância-estatitística-das-variáveis" class="level3">
<h3 class="anchored" data-anchor-id="análise-da-significância-estatitística-das-variáveis">4.1 Análise da Significância Estatitística das Variáveis</h3>
<p>Assim sendo, iniciaremos a análise implementando o nosso modelo e gerando um sumário estatístico. Através desse sumário, poderemos, por exemplo, avaliar a significância estatística das variáveis.</p>
<p>Criando o modelo de regressão linear e exibindo um sumário:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Criando modelo de regressão linear</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>modelo <span class="ot">&lt;-</span> <span class="fu">lm</span>(desempenho <span class="sc">~</span> idade <span class="sc">+</span> horas_estudo <span class="sc">+</span> frequencia <span class="sc">+</span> atividade_extracurricular <span class="sc">+</span> nivel_socioeconomico <span class="sc">+</span> motivacao <span class="sc">+</span> notas_anteriores <span class="sc">+</span> sono <span class="sc">+</span> desempenho, <span class="at">data =</span> dados)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in model.matrix.default(mt, mf, contrasts): the response appeared on
the right-hand side and was dropped</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in model.matrix.default(mt, mf, contrasts): problem with term 9 in
model.matrix: no columns are assigned</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Exibindo resultados</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = desempenho ~ idade + horas_estudo + frequencia + 
    atividade_extracurricular + nivel_socioeconomico + motivacao + 
    notas_anteriores + sono + desempenho, data = dados)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.2374 -1.3748 -0.1003  1.4228  6.0523 

Coefficients:
                              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                   1.676967   1.442204   1.163    0.245    
idade                         0.035082   0.063316   0.554    0.580    
horas_estudo                  0.476040   0.029477  16.149  &lt; 2e-16 ***
frequencia                    0.300170   0.009151  32.803  &lt; 2e-16 ***
atividade_extracurricularSim  2.230537   0.135026  16.519  &lt; 2e-16 ***
nivel_socioeconomicoBaixo     0.207329   0.191807   1.081    0.280    
nivel_socioeconomicoMédio     0.240386   0.174924   1.374    0.170    
motivacao                    -0.271728   0.033495  -8.112 1.59e-15 ***
notas_anteriores              0.219761   0.045138   4.869 1.32e-06 ***
sono                         -0.366070   0.066055  -5.542 3.91e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.992 on 915 degrees of freedom
  (18 observations deleted due to missingness)
Multiple R-squared:  0.675, Adjusted R-squared:  0.6718 
F-statistic: 211.1 on 9 and 915 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p><strong>Interpretação</strong>: Considerando um <strong>nível de significância de 5% (α = 0.05),</strong> os dados do modelo de <strong>regressão linear múltipla</strong> e sabendo que as variáveis que são estaticamente significativas para o modelo são aquelas com <strong>p-valor &lt; 0.05,</strong> podemos concluir que as seguintes variáveis tem um efeito estatisticamente significativo para explicar o <strong>desempenho do aluno</strong>:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 38%">
<col style="width: 23%">
<col style="width: 38%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Variável</th>
<th style="text-align: center;">Coef. Estimado</th>
<th style="text-align: center;">Interpretação</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><code>horas_estudo</code></td>
<td style="text-align: center;">0.476</td>
<td style="text-align: center;">A cada hora de estudo, o desempenho do aluno aumenta em 47.6%.</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>frequencia</code></td>
<td style="text-align: center;">0.300</td>
<td style="text-align: center;">A cada frequência/presença do aluno nas aulas, seu desempenho aumenta em 30%.</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>atividade_extracurricularSim</code></td>
<td style="text-align: center;">2.230</td>
<td style="text-align: center;">Alunos que participam de atividades extracurriculares apresenta um desempenho 2.23 maior em relação a alunos que não participam de atividades extracurriculares.</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>motivacao</code></td>
<td style="text-align: center;">-0.271</td>
<td style="text-align: center;">Alunos que são mais motivados tendem a possuir um desempenho menor, contudo, isto é indicativo de multicolinearidade, pois em nossa análise anterior, vimos que alunos com motivação maior possuem na realidade um melhor desempenho que alunos menos motivados.</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>notas_anteriores</code></td>
<td style="text-align: center;">0.219</td>
<td style="text-align: center;">Alunos que possuem notas anteiores melhores possuem um desempenho de 21.9% melhor em relação a alunos com notas anteriores piores.</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>sono</code></td>
<td style="text-align: center;">-0.366</td>
<td style="text-align: center;">Mais sono está associado a menor desempenho. (Isso pode indicar noites mais longas de sono em vez de tempo ideal de descanso.)</td>
</tr>
</tbody>
</table>
<p>Por fim, as seguintes variáveis não possuem um efeito estatisticamente significativo para explicar o desempenho do aluno <strong>(p-valor &gt; 0.05):</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Variável</th>
<th style="text-align: center;">p-valor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><code>idade</code></td>
<td style="text-align: center;">0.580</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>nivel_socioeconomicoBaixo</code></td>
<td style="text-align: center;">0.207</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>nivel_socioeconomicoMedio</code></td>
<td style="text-align: center;">0.170</td>
</tr>
</tbody>
</table>
<p><strong>Observação</strong>: a variável <code>nivel_socioeconomico</code> é categórica. Isso significa que ela está sendo comparada a uma classe referência. No nosso caso a referência é <code>nivel_socioeconomicoAlto</code> . Como nenhuma das classes não possui um efeito estatisticamente significativo, podemos desconsiderá-la.</p>
</section>
<section id="diagnóstico-de-multicolinearidade" class="level3">
<h3 class="anchored" data-anchor-id="diagnóstico-de-multicolinearidade">4.2 Diagnóstico de Multicolinearidade</h3>
<p>Conforme observamos na análise da significância, o coeficiente estimado da variável <code>motivacao</code> resultou em um valog negativo, porém, não faz sentido, pois alunos mais motivados tendem a ter um melhor desempenho. Quando inconsistências assim ocorrem em nossa análise isso pode nos indicar que há uma <strong>multicolinearidade</strong> entre duas ou mais variáveis.</p>
<p>Um dos objetivos da análise de regressão é analisar de maneira isolada a relação entre a variável de interesse (no nosso caso <code>desempenho</code>) e as demais variáveis (<code>idade</code>, <code>notas_anteriores</code>, etc.). Nesse contexto, quando duas ou mais variáveis são altamente correlacionadas fica difícil de estimar a correlação entre as variáveis de forma independente. Este problema é chamado de <strong>multicolinearidade.</strong></p>
<p>A fim de investigar se há multicolinearidade ou não em nosso modelo, utilizaremos a medida estatística conhecida como <strong>Variance Inflation Factor (VIF).</strong> A VIF começa com o valor 1 e não possuí um limite superior. De forma resumida ela funciona da seguinte maneira:</p>
<ul>
<li><p>VIF = 1 Indica que não há multicolinearidade;</p></li>
<li><p>1 &lt; VIF &lt;= 5 indica que há uma correlação moderada</p></li>
<li><p>VIF &gt; 5 indica que há uma forte correlação</p></li>
</ul>
<p>Calculando o valor da medida estatística VIF:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">require</span>(car)) <span class="fu">install.packages</span>(<span class="st">"car"</span>)  <span class="co"># pacote que possui a função vif</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: car</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: carData</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'car'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    recode</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>The following package(s) will be installed:
- car [3.1-3]
These packages will be installed into "~/Projeto Estatística/renv/library/macos/R-4.4/x86_64-apple-darwin20".

# Installing packages --------------------------------------------------------
- Installing car ...                            OK [linked from cache]
Successfully installed 1 package in 8.6 milliseconds.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Imprimindo medida estatística vif para o nosso modelo</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(modelo) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in model.matrix.default(mod, data = structure(list(desempenho = c(29.7,
: the response appeared on the right-hand side and was dropped</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in model.matrix.default(mod, data = structure(list(desempenho = c(29.7,
: problem with term 9 in model.matrix: no columns are assigned</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                              GVIF Df GVIF^(1/(2*Df))
idade                     1.003597  1        1.001797
horas_estudo              5.115839  1        2.261822
frequencia                1.004422  1        1.002208
atividade_extracurricular 1.008862  1        1.004421
nivel_socioeconomico      1.013332  2        1.003316
motivacao                 5.109902  1        2.260509
notas_anteriores          1.009673  1        1.004825
sono                      1.009262  1        1.004620
desempenho                9.283433  0             Inf</code></pre>
</div>
</div>
<p>Observa-se que:</p>
<ul>
<li><p><code>motivacao</code>: VIF &gt; 5</p></li>
<li><p><code>horas_estudo</code>: VIF &gt; 5</p></li>
</ul>
<p>Portanto, há um forte indício de multicolinearidade entre as duas variáveis, ou seja, elas são altamente correlacionados.</p>
</section>
</section>
<section id="seleção-do-modelo" class="level2">
<h2 class="anchored" data-anchor-id="seleção-do-modelo">5. Seleção do Modelo</h2>
<p>Feito a análise bivariada, análise de regressão e diagnóstico de multicolinearidade do modelo, nesta etapa iremos realizar a seleção do modelo utilizando os resultados observáveis nas análises anteriores para decidir quais variáveis utilizar, etc. No final desta etapa, o objetivo é termos um modelo de regressão linear múltipla mais simples e adequado para o nosso propósito.</p>
<p>Iniciaremos nossa seleção atulizando o modelo com o objetivo de retirar as variáveis não significativas. Após isso, utilizaremos medidas estatísticas para comparar os modelos e selecionar o mais adequado.</p>
<p>Segue o sumário do modelo inicial para referência das variáveis significativas e não significativas:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = desempenho ~ idade + horas_estudo + frequencia + 
    atividade_extracurricular + nivel_socioeconomico + motivacao + 
    notas_anteriores + sono + desempenho, data = dados)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.2374 -1.3748 -0.1003  1.4228  6.0523 

Coefficients:
                              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                   1.676967   1.442204   1.163    0.245    
idade                         0.035082   0.063316   0.554    0.580    
horas_estudo                  0.476040   0.029477  16.149  &lt; 2e-16 ***
frequencia                    0.300170   0.009151  32.803  &lt; 2e-16 ***
atividade_extracurricularSim  2.230537   0.135026  16.519  &lt; 2e-16 ***
nivel_socioeconomicoBaixo     0.207329   0.191807   1.081    0.280    
nivel_socioeconomicoMédio     0.240386   0.174924   1.374    0.170    
motivacao                    -0.271728   0.033495  -8.112 1.59e-15 ***
notas_anteriores              0.219761   0.045138   4.869 1.32e-06 ***
sono                         -0.366070   0.066055  -5.542 3.91e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.992 on 915 degrees of freedom
  (18 observations deleted due to missingness)
Multiple R-squared:  0.675, Adjusted R-squared:  0.6718 
F-statistic: 211.1 on 9 and 915 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<section id="remoção-das-variáveis-não-significativas" class="level3">
<h3 class="anchored" data-anchor-id="remoção-das-variáveis-não-significativas">5.1 Remoção das Variáveis Não Significativas</h3>
<p>Primeiramente, removeremos as variáveis não significativas <code>idade</code> e <code>nivel_socioeconomico</code> :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Removendo idade</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>modelo_sem_idade <span class="ot">&lt;-</span> <span class="fu">update</span>(modelo, . <span class="sc">~</span> . <span class="sc">-</span> idade)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in model.matrix.default(mt, mf, contrasts): the response appeared on
the right-hand side and was dropped</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in model.matrix.default(mt, mf, contrasts): problem with term 8 in
model.matrix: no columns are assigned</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Removendo nivel_socioeconomico</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>modelo_simplificado <span class="ot">&lt;-</span> <span class="fu">update</span>(modelo_sem_idade, . <span class="sc">~</span> . <span class="sc">-</span> nivel_socioeconomico)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in model.matrix.default(mt, mf, contrasts): the response appeared on
the right-hand side and was dropped</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in model.matrix.default(mt, mf, contrasts): problem with term 7 in
model.matrix: no columns are assigned</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sumario do modelo simplificado</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_simplificado)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = desempenho ~ horas_estudo + frequencia + atividade_extracurricular + 
    motivacao + notas_anteriores + sono + desempenho, data = dados)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.1448 -1.4077 -0.0889  1.4418  6.0996 

Coefficients:
                              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                   2.416665   1.002754   2.410   0.0161 *  
horas_estudo                  0.474304   0.029422  16.121  &lt; 2e-16 ***
frequencia                    0.300280   0.009138  32.862  &lt; 2e-16 ***
atividade_extracurricularSim  2.222924   0.134679  16.505  &lt; 2e-16 ***
motivacao                    -0.270154   0.033451  -8.076 2.09e-15 ***
notas_anteriores              0.220588   0.045102   4.891 1.19e-06 ***
sono                         -0.366958   0.065913  -5.567 3.40e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.992 on 918 degrees of freedom
  (18 observations deleted due to missingness)
Multiple R-squared:  0.6742,    Adjusted R-squared:  0.672 
F-statistic: 316.6 on 6 and 918 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Comparando AIC do <code>modelo_simplificado</code> e do <code>modelo</code> completo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(modelo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3912.297</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(modelo_simplificado) <span class="co"># sem idade e nivel socioeconomico</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3908.553</code></pre>
</div>
</div>
<p>Nota-se que o <code>modelo_completo</code> possui um AIC menor que o <code>modelo</code> inicial. Outra medida que podemos utilizar para comparar é a <strong>Critério de Informação Bayesiano (BIC).</strong> O modelo que apresentar a menor BIC são preferidos, pois apresentam melhor ajuste aos dados com número menor de parâmetros.</p>
<p>Comparando BIC do <code>modelo_simplificado</code> e do <code>modelo</code> completo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(modelo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3965.425</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(modelo_simplificado)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3947.192</code></pre>
</div>
</div>
<p>Isso confirma que o <code>modelo_simplificado</code> está mais ajustado e adequado para nossos propósitos.</p>
</section>
<section id="motivação-ou-horas-de-estudo-resolvendo-o-grande-elefante-branco-na-sala-multicolinearidade" class="level3">
<h3 class="anchored" data-anchor-id="motivação-ou-horas-de-estudo-resolvendo-o-grande-elefante-branco-na-sala-multicolinearidade">5.2 Motivação ou Horas de Estudo? Resolvendo O Grande Elefante Branco na Sala: Multicolinearidade</h3>
<p>Finalmente, é hora de resolvermos a multicolinearidade. Para resolver este problema, utilizaremos a mesma abordagem acima. Atualizaremos o modelo manualmente e, através dos critérios estatísticos AIC e BIC, escolheremos a variável que mais ajuda a explicar o desempenho do estudante. Para isso, precisamos relembrar que as variáveis causadoras desse problema são: <code>motivacao</code> e <code>horas_estudo</code> .</p>
<p>Removendo <code>motivacao</code> do <code>modelo_simplificado</code> :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>modelo_sem_motivacao <span class="ot">&lt;-</span> <span class="fu">update</span>(modelo_simplificado, . <span class="sc">~</span> . <span class="sc">-</span> motivacao)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in model.matrix.default(mt, mf, contrasts): the response appeared on
the right-hand side and was dropped</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in model.matrix.default(mt, mf, contrasts): problem with term 6 in
model.matrix: no columns are assigned</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_sem_motivacao)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = desempenho ~ horas_estudo + frequencia + atividade_extracurricular + 
    notas_anteriores + sono + desempenho, data = dados)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.0186 -1.4246 -0.0734  1.4258  5.9407 

Coefficients:
                              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                   1.475033   1.030165   1.432    0.153    
horas_estudo                  0.261267   0.013479  19.383  &lt; 2e-16 ***
frequencia                    0.299376   0.009451  31.677  &lt; 2e-16 ***
atividade_extracurricularSim  2.191061   0.139245  15.735  &lt; 2e-16 ***
notas_anteriores              0.202104   0.046592   4.338 1.60e-05 ***
sono                         -0.397516   0.068065  -5.840 7.23e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.06 on 919 degrees of freedom
  (18 observations deleted due to missingness)
Multiple R-squared:  0.651, Adjusted R-squared:  0.6491 
F-statistic: 342.9 on 5 and 919 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Removendo <code>horas_estudo</code> do <code>modelo_simplificado</code> :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>modelo_sem_horas_estudo <span class="ot">&lt;-</span> <span class="fu">update</span>(modelo_simplificado, . <span class="sc">~</span> . <span class="sc">-</span> horas_estudo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in model.matrix.default(mt, mf, contrasts): the response appeared on
the right-hand side and was dropped</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in model.matrix.default(mt, mf, contrasts): problem with term 6 in
model.matrix: no columns are assigned</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_sem_horas_estudo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = desempenho ~ frequencia + atividade_extracurricular + 
    motivacao + notas_anteriores + sono + desempenho, data = dados)

Residuals:
    Min      1Q  Median      3Q     Max 
-6.4150 -1.4878 -0.0289  1.4296  6.7518 

Coefficients:
                             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                   2.35316    1.12327   2.095 0.036447 *  
frequencia                    0.29731    0.01027  28.947  &lt; 2e-16 ***
atividade_extracurricularSim  2.16381    0.15126  14.305  &lt; 2e-16 ***
motivacao                     0.21151    0.01666  12.693  &lt; 2e-16 ***
notas_anteriores              0.18894    0.05086   3.715 0.000216 ***
sono                         -0.43250    0.07405  -5.841 7.19e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.252 on 929 degrees of freedom
  (8 observations deleted due to missingness)
Multiple R-squared:  0.5813,    Adjusted R-squared:  0.5791 
F-statistic:   258 on 5 and 929 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Comparando os dois modelos com as medidas <strong>AIC</strong> e <strong>BIC:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(modelo_sem_motivacao)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3970.044</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(modelo_sem_horas_estudo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4179.175</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(modelo_sem_motivacao)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4003.853</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(modelo_sem_horas_estudo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4213.059</code></pre>
</div>
</div>
<p>Nota-se, através da análise realizada, que o modelo mais adequado e ajustado é aquele sem a variável <code>motivacao</code> e com a variável <code>horas_estudo.</code>, ou seja, o <code>modelo_sem_motivacao</code>.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>